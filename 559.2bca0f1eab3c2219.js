"use strict";(self.webpackChunkfrosthaven_assistant_angular=self.webpackChunkfrosthaven_assistant_angular||[]).push([[559],{8559:(O,p,r)=>{r.r(p),r.d(p,{AlchemyComponent:()=>k});var u=r(467),a=r(2200),d=r(4341),t=r(3664);function h(i,c){1&i&&t.nrm(0,"div",6),2&i&&t.HbH(c.$implicit)}function m(i,c){if(1&i&&(t.j41(0,"div",4),t.DNE(1,h,1,2,"div",5),t.k0s()),2&i){const n=t.XpG();t.R7$(),t.Y8G("ngForOf",n.getPotionResources())}}let g=(()=>{class i{potion;unlockedPotionIds;brewPotion=new t.bkB;constructor(){}getPotionSrc(n){let o=n.name.toLocaleLowerCase();o=o.replaceAll(" ","-");let e=n.id<100?"0"+n.id:n.id;return this.isPotionLocked()?"./images/fh/items/item-back-fh.png":`./images/potions/fh-${e}-${o}.jpeg`}isPotionLocked(){return this.unlockedPotionIds?.indexOf(this.potion.id)<0}getPotionResources(){return Object.keys(this.potion.resources)}brew(){this.brewPotion.emit(this.potion.resources)}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-single-potion"]],inputs:{potion:"potion",unlockedPotionIds:"unlockedPotionIds"},outputs:{brewPotion:"brewPotion"},decls:5,vars:3,consts:[[1,"potion",3,"click"],[1,"id"],[3,"src"],["class","resources",4,"ngIf"],[1,"resources"],["class","icon",3,"class",4,"ngFor","ngForOf"],[1,"icon"]],template:function(o,e){1&o&&(t.j41(0,"div",0),t.bIt("click",function(){return e.brew()}),t.j41(1,"div",1),t.EFF(2),t.k0s(),t.nrm(3,"img",2),t.DNE(4,m,2,1,"div",3),t.k0s()),2&o&&(t.R7$(2),t.JRh(e.potion.id),t.R7$(),t.Y8G("src",e.getPotionSrc(e.potion),t.B4B),t.R7$(),t.Y8G("ngIf",e.isPotionLocked()))},dependencies:[a.MD,a.Sq,a.bT,d.YN],styles:[".potion[_ngcontent-%COMP%]{position:relative;cursor:pointer}.potion[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:10px}.potion[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:160px;height:240px}.potion[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{position:absolute;height:100%;display:flex;gap:.3rem;flex-direction:column;right:0;top:0;justify-content:center}.potion[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:var(--font-color)}"]})}return i})();var P=r(7556),l=r(2615),_=r(4384),v=r(1948);function b(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",8),t.nrm(1,"div",9),t.j41(2,"input",10),t.mxI("ngModelChange",function(e){const s=l.eBV(n).$implicit,f=t.XpG();return t.DH7(f.inventory[s],e)||(f.inventory[s]=e),l.Njj(e)}),t.k0s()()}if(2&i){const n=c.$implicit,o=t.XpG();t.R7$(),t.HbH(n),t.R7$(),t.R50("ngModel",o.inventory[n])}}function C(i,c){if(1&i){const n=t.RV6();t.j41(0,"div")(1,"app-single-potion",11),t.bIt("brewPotion",function(e){l.eBV(n);const s=t.XpG();return l.Njj(s.brewPotion(e))}),t.k0s()()}if(2&i){const n=c.$implicit,o=t.XpG();t.R7$(),t.Y8G("potion",n)("unlockedPotionIds",o.unlockedPotionIds)}}function y(i,c){if(1&i){const n=t.RV6();t.j41(0,"div")(1,"app-single-potion",11),t.bIt("brewPotion",function(e){l.eBV(n);const s=t.XpG();return l.Njj(s.brewPotion(e))}),t.k0s()()}if(2&i){const n=c.$implicit,o=t.XpG();t.R7$(),t.Y8G("potion",n)("unlockedPotionIds",o.unlockedPotionIds)}}let k=(()=>{class i{dataLoader;db;unlockedPotionIds;potions;twoHerbsPotions=[];threeHerbsPotions=[];wierdPotions=[];inventory={};RESOURCE_KEYS;constructor(n,o){this.dataLoader=n,this.db=o,this.filterCraftable(),this.RESOURCE_KEYS=this.dataLoader.HERB_RESOURCE_KEYS}ngOnInit(){var n=this;return(0,u.A)(function*(){yield n.loadUnlockedPotions()})()}splitByHerbsCount(){this.twoHerbsPotions=[],this.threeHerbsPotions=[],this.wierdPotions=[],this.potions.forEach(n=>{const o=Object.keys(n.resources).length;2===o?this.twoHerbsPotions.push(n):3===o?this.threeHerbsPotions.push(n):this.wierdPotions.push(n)})}filterCraftable(){this.potions=this.dataLoader.getPotionsItems().filter(n=>this.canCraft(n.resources)),this.splitByHerbsCount()}clear(){this.inventory={},this.filterCraftable()}brewPotion(n){for(const o in n)this.inventory[o]=(this.inventory[o]??0)-(n[o]??0);this.filterCraftable()}loadUnlockedPotions(){var n=this;return(0,u.A)(function*(){const o=yield n.db.getUnlockedPotions();n.unlockedPotionIds=o.map(e=>e.id)})()}canCraft(n){if(this.isInventoryEmpty())return!0;for(const o in n)if((this.inventory[o]??0)<(n[o]??0))return!1;return!0}isInventoryEmpty(){for(const n in this.inventory)if(0!=(this.inventory[n]??0))return!1;return!0}static \u0275fac=function(o){return new(o||i)(t.rXU(_.y),t.rXU(v.a))};static \u0275cmp=t.VBU({type:i,selectors:[["app-alchemy"]],decls:15,vars:3,consts:[[1,"filters","content"],["class","herbs",4,"ngFor","ngForOf"],[1,"cancel",3,"click"],[1,"potions-container"],[1,"title"],[1,"two-herbs","container"],[4,"ngFor","ngForOf"],[1,"three-herbs","container"],[1,"herbs"],[1,"icon"],["type","tel","placeholder","#",3,"ngModelChange","ngModel"],[3,"brewPotion","potion","unlockedPotionIds"]],template:function(o,e){1&o&&(t.j41(0,"div",0),t.DNE(1,b,3,3,"div",1),t.j41(2,"button",2),t.bIt("click",function(){return e.filterCraftable()}),t.EFF(3,"Brew"),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return e.clear()}),t.EFF(5,"All"),t.k0s()(),t.j41(6,"div",3)(7,"div",4),t.EFF(8,"Two herbs"),t.k0s(),t.j41(9,"div",5),t.DNE(10,C,2,2,"div",6),t.k0s(),t.j41(11,"div",4),t.EFF(12,"Three herbs"),t.k0s(),t.j41(13,"div",7),t.DNE(14,y,2,2,"div",6),t.k0s()()),2&o&&(t.R7$(),t.Y8G("ngForOf",e.RESOURCE_KEYS),t.R7$(9),t.Y8G("ngForOf",e.twoHerbsPotions),t.R7$(4),t.Y8G("ngForOf",e.threeHerbsPotions))},dependencies:[a.MD,a.Sq,d.YN,d.me,d.BC,d.vS,g,P.S],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:.3rem}.filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem}.filters[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-direction:row;align-items:center}@media (max-width: 768px){.container[_ngcontent-%COMP%]{justify-content:space-around}.filters[_ngcontent-%COMP%]{flex-direction:column}.title[_ngcontent-%COMP%]{justify-content:center}}"]})}return i})()}}]);