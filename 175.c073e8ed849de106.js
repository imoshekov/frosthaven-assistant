"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[175],{7556:(X,P,p)=>{p.d(P,{S:()=>b});var l=p(3664);let b=(()=>{class v{el;previousValue="";constructor(C){this.el=C}onFocus(){this.previousValue=this.el.nativeElement.value,this.el.nativeElement.value=""}onBlur(){""===this.el.nativeElement.value&&(this.el.nativeElement.value=this.previousValue,this.el.nativeElement.dispatchEvent(new Event("input",{bubbles:!0})))}static \u0275fac=function(t){return new(t||v)(l.rXU(l.aKT))};static \u0275dir=l.FsC({type:v,selectors:[["input","type","tel"]],hostBindings:function(t,s){1&t&&l.bIt("focus",function(){return s.onFocus()})("blur",function(){return s.onBlur()})}})}return v})()},9175:(X,P,p)=>{p.r(P),p.d(P,{ScenarioComponent:()=>ue});var l=p(2200),b=p(1413),v=p(6977),m=p(4341),C=p(7556),t=p(3664),s=p(2615),_=p(4675);const V=(o,c,e)=>[o,c,e];function H(o,c){if(1&o&&(t.j41(0,"div",8),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.SpI(" ",e.creature.type," ")}}function U(o,c){if(1&o&&(t.j41(0,"div",8)(1,"div",9)(2,"span",10),t.EFF(3),t.k0s()()()),2&o){const e=t.XpG();t.R7$(3),t.JRh(e.creature.level)}}function z(o,c){1&o&&t.nrm(0,"div",21)}function J(o,c){if(1&o&&(t.j41(0,"span",15),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.JRh(e.creature.attackTarget)}}function Q(o,c){if(1&o&&(t.j41(0,"div",13)(1,"div",22),t.EFF(2),t.k0s()()),2&o){const e=t.XpG(2);t.R7$(2),t.JRh(e.creature.armor+e.creature.roundArmor)}}function W(o,c){if(1&o&&(t.j41(0,"div",25),t.EFF(1),t.k0s()),2&o){const e=t.XpG(3);t.R7$(),t.JRh(e.creature.retaliateRange)}}function Z(o,c){if(1&o&&(t.j41(0,"div",13)(1,"div",23),t.EFF(2),t.k0s(),t.DNE(3,W,2,1,"div",24),t.k0s()),2&o){const e=t.XpG(2);t.R7$(2),t.JRh(e.creature.retaliate+e.creature.roundRetaliate),t.R7$(),t.Y8G("ngIf",e.creature.retaliateRange>0)}}function K(o,c){1&o&&t.nrm(0,"div",28),2&o&&t.HbH(c.$implicit.value)}function q(o,c){if(1&o&&(t.j41(0,"div",26),t.DNE(1,K,1,2,"div",27),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.creature.actions)}}function tt(o,c){1&o&&(t.j41(0,"div",13),t.nrm(1,"div",29),t.k0s())}function et(o,c){if(1&o&&(t.j41(0,"div",11)(1,"div",12)(2,"div",13),t.nrm(3,"div",14),t.j41(4,"span",15),t.EFF(5),t.k0s(),t.DNE(6,z,1,0,"div",16)(7,J,2,1,"span",17),t.k0s(),t.DNE(8,Q,3,1,"div",18)(9,Z,4,2,"div",18)(10,q,2,1,"div",19),t.k0s(),t.j41(11,"div",12)(12,"div",13),t.nrm(13,"div",20),t.j41(14,"span",15),t.EFF(15),t.k0s()(),t.DNE(16,tt,2,0,"div",18),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.AVh("bordered",e.hasExtraStats(e.creature)),t.R7$(3),t.JRh(e.creature.attack),t.R7$(),t.Y8G("ngIf",e.creature.attackTarget>1),t.R7$(),t.Y8G("ngIf",e.creature.attackTarget>1),t.R7$(),t.Y8G("ngIf",e.creature.armor+e.creature.roundArmor>0),t.R7$(),t.Y8G("ngIf",e.creature.retaliate+e.creature.roundRetaliate>0),t.R7$(),t.Y8G("ngIf",e.creature.aggressive&&(null==e.creature.actions?null:e.creature.actions.length)),t.R7$(2),t.AVh("bordered",e.creature.flying),t.R7$(3),t.JRh(e.creature.movement),t.R7$(),t.Y8G("ngIf",e.creature.flying)}}function nt(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",30)(4,"input",31),t.bIt("blur",function(n){s.eBV(e);const i=t.XpG();return s.Njj(i.appContext.updateCreatureBaseStat(i.creature.id,"hp",+n.target.value,!0))}),t.k0s()()()(),t.j41(5,"div",12)(6,"div",13)(7,"div",32)(8,"input",33),t.bIt("blur",function(n){s.eBV(e);const i=t.XpG();return s.Njj(i.appContext.updateCreatureBaseStat(i.creature.id,"sessionExperience",+n.target.value,!0))})("click",function(){s.eBV(e);const n=t.XpG();return s.Njj(n.appContext.updateCreatureBaseStat(n.creature.id,"sessionExperience",(n.creature.sessionExperience??0)+1,!0))}),t.k0s()()()()()}if(2&o){const e=t.XpG();t.R7$(4),t.Y8G("value",e.creature.hp),t.R7$(4),t.Y8G("value",e.creature.sessionExperience)}}let ot=(()=>{class o{appContext;creature;constructor(e){this.appContext=e}getCreaturePic(e){return e.aggressive?e.boss?"./images/bb/daemon-skull.svg":`./images/monster/thumbnail/fh-${e?.type}.png`:`./images/character/thumbnail/fh-${e?.type}.png`}onImgError(e){e.target.src="./images/bb/daemon-skull.svg"}openConditionModal(){this.appContext.selectedCreature=this.creature,this.appContext.isGroupSelected=!0}hasExtraStats(e){return e.armor+e.roundArmor>0||e.retaliate+e.roundRetaliate>0||e.aggressive&&e.actions?.length>0||e.flying}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-creature-group-header"]],inputs:{creature:"creature"},decls:10,vars:11,consts:[[1,"creature-details",3,"ngClass"],[1,"base-stat","row"],[1,"creature-initiative"],["type","tel","maxlength","2",1,"stat-input",3,"blur","value"],["class","name",4,"ngIf"],[1,"info","row"],[1,"profile",3,"error","click","src"],["class","group-stats",4,"ngIf"],[1,"name"],[1,"icon","level"],[1,"level-number"],[1,"group-stats"],[1,"stats"],[1,"base-stat"],[1,"icon","attack"],[1,"stat-value"],["class","icon target",4,"ngIf"],["class","stat-value",4,"ngIf"],["class","base-stat",4,"ngIf"],["class","traits",4,"ngIf"],[1,"icon","move"],[1,"icon","target"],[1,"icon","shield"],[1,"icon","retaliate"],["class","icon range",4,"ngIf"],[1,"icon","range"],[1,"traits"],["class","icon",3,"class",4,"ngFor","ngForOf"],[1,"icon"],[1,"icon","flying"],[1,"icon","heart"],["type","tel","maxlength","3",1,"stat-input",3,"blur","value"],[1,"icon","xp"],["type","tel","maxlength","3",1,"stat-input",3,"blur","click","value"]],template:function(r,n){1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),t.bIt("blur",function(a){return n.appContext.updateCreatureBaseStat(n.creature.id,"initiative",+a.target.value,!0)}),t.k0s()(),t.DNE(4,H,2,1,"div",4)(5,U,4,1,"div",4),t.k0s(),t.j41(6,"div",5)(7,"img",6),t.bIt("error",function(a){return n.onImgError(a)})("click",function(){return n.openConditionModal()}),t.k0s(),t.DNE(8,et,17,12,"div",7)(9,nt,9,2,"div",7),t.k0s()()),2&r&&(t.Y8G("ngClass",t.sMw(7,V,n.creature.type,n.creature.boss?"boss":n.creature.isElite?"elite":"non-elite",n.creature.aggressive?"":"character")),t.R7$(3),t.Y8G("value",n.creature.initiative),t.R7$(),t.Y8G("ngIf",n.creature.aggressive),t.R7$(),t.Y8G("ngIf",!n.creature.aggressive),t.R7$(2),t.Y8G("src",n.getCreaturePic(n.creature),t.B4B),t.R7$(),t.Y8G("ngIf",n.creature.aggressive),t.R7$(),t.Y8G("ngIf",!n.creature.aggressive))},dependencies:[l.MD,l.YU,l.Sq,l.bT,C.S,m.YN],styles:[".creature-details[_ngcontent-%COMP%]{flex-direction:column;justify-content:space-between;align-items:center;padding:0 10px 10px;display:flex;width:calc(100% - 20px);min-height:135px}.creature-details.elite[_ngcontent-%COMP%]{background:var(--elite-color)}.creature-details.non-elite[_ngcontent-%COMP%]{background:var(--nonelite-color)}.creature-details.boss[_ngcontent-%COMP%]{background:var(--boss-color)}.creature-details.character.coral[_ngcontent-%COMP%]{background-color:var(--coral-color)}.creature-details.character.fist[_ngcontent-%COMP%]{background-color:var(--fist-color)}.creature-details.character.blinkblade[_ngcontent-%COMP%]{background-color:var(--blinkblade-color)}.creature-details.character.banner-spear[_ngcontent-%COMP%]{background-color:var(--banner-spear-color)}.creature-details.character.meteor[_ngcontent-%COMP%]{background-color:var(--meteor-color)}.creature-details.character.drifter[_ngcontent-%COMP%]{background-color:var(--drifter-color)}.creature-details.character[_ngcontent-%COMP%]{background-color:var(--character-bg, var(--background-secondary))}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;justify-content:center;align-items:center}.name[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:.5rem}.name[_ngcontent-%COMP%]   .icon.level[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:50px;height:50px;padding-top:0}.name[_ngcontent-%COMP%]   .icon.level[_ngcontent-%COMP%]   .level-number[_ngcontent-%COMP%]{display:inline-block;font-size:15px;transform:translateY(5px)}.right-info[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:10px}.base-stat[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}.base-stat[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:none;color:var(--font-color);border:none}img.profile[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:50%;box-shadow:0 0 5px 2px;-webkit-user-select:none;user-select:none}.base-info[_ngcontent-%COMP%], .group-stats[_ngcontent-%COMP%]{display:flex}.base-info[_ngcontent-%COMP%]   .traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .group-stats[_ngcontent-%COMP%]   .traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:30px;height:40px}.bordered[_ngcontent-%COMP%]{border-right:1px solid var(--secondary-color);padding-right:10px}.group-stats[_ngcontent-%COMP%]{flex-direction:column;flex-shrink:2;margin-left:20px}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{justify-content:flex-start;display:flex;margin-top:5px;gap:.5rem;flex-wrap:nowrap}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:.5rem}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:30px;height:30px;display:flex;justify-content:center;align-items:center}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon.shield[_ngcontent-%COMP%], .group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon.retaliate[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon.range[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding-right:20px}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon.heart[_ngcontent-%COMP%], .group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon.xp[_ngcontent-%COMP%]{width:35px;height:35px}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .icon.level[_ngcontent-%COMP%]{width:45px;height:45px;justify-content:center;align-items:center}.group-stats[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .base-stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{min-width:12px}.group-stats[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px}"]})}return o})();const rt=(o,c)=>[o,c];function it(o,c){if(1&o&&(t.j41(0,"div",7),t.EFF(1),t.nrm(2,"div",10),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.creature.retaliateRange," ")}}function at(o,c){if(1&o&&(t.j41(0,"div",4)(1,"div",5),t.EFF(2),t.nrm(3,"div",6),t.k0s(),t.j41(4,"div",7),t.EFF(5),t.nrm(6,"div",8),t.k0s(),t.DNE(7,it,3,1,"div",9),t.k0s()),2&o){const e=t.XpG();t.R7$(2),t.SpI(" ",e.creature.armor+e.creature.roundArmor," "),t.R7$(3),t.SpI(" ",e.creature.retaliate+e.creature.roundRetaliate," "),t.R7$(2),t.Y8G("ngIf",e.creature.retaliateRange>0)}}function ct(o,c){1&o&&t.nrm(0,"div",14)}function st(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",11),t.bIt("click",function(){const n=s.eBV(e).$implicit,i=t.XpG();return s.Njj(i.toggleCondition(n))}),t.nrm(1,"div",12),t.DNE(2,ct,1,0,"div",13),t.k0s()}if(2&o){const e=c.$implicit,r=t.XpG();t.AVh("is-immune",r.isImmune(e)),t.R7$(),t.Y8G("ngClass",t.l_i(4,rt,e,r.isActive(e)?"active":"")),t.R7$(),t.Y8G("ngIf",r.isImmune(e))}}let T=(()=>{class o{creature;conditions;immunities;shouldShowBuffs;activeConditions=[];activeImmunities=[];conditionToggled=new t.bkB;constructor(){}ngOnInit(){this.creature?.conditions?.forEach(e=>{this.activeConditions.push(e)}),this.creature?.immunities?.forEach(e=>{this.activeImmunities.push(e)})}toggleCondition(e){this.isImmune(e)||(this.activeConditions.includes(e)?this.removeCondition(e):this.activeConditions.push(e),this.conditionToggled.emit(e))}isActive(e){return this.activeConditions.includes(e)}isImmune(e){return this.activeImmunities.includes(e)}removeCondition(e){const r=this.activeConditions.findIndex(n=>n===e);-1!==r&&this.activeConditions.splice(r,1)}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-conditions"]],inputs:{creature:"creature",conditions:"conditions",immunities:"immunities",shouldShowBuffs:"shouldShowBuffs"},outputs:{conditionToggled:"conditionToggled"},decls:4,vars:2,consts:[[1,"container"],["class","buffs",4,"ngIf"],[1,"conditions"],["class","condition-element",3,"is-immune","click",4,"ngFor","ngForOf"],[1,"buffs"],[1,"armor","stat"],[1,"icon","shield"],[1,"retaliate","stat"],[1,"icon","retaliate"],["class","retaliate stat",4,"ngIf"],[1,"icon","range"],[1,"condition-element",3,"click"],[1,"icon",3,"ngClass"],["class","icon immune",4,"ngIf"],[1,"icon","immune"]],template:function(r,n){1&r&&(t.j41(0,"div",0),t.DNE(1,at,8,3,"div",1),t.j41(2,"div",2),t.DNE(3,st,3,7,"div",3),t.k0s()()),2&r&&(t.R7$(),t.Y8G("ngIf",n.shouldShowBuffs),t.R7$(2),t.Y8G("ngForOf",n.conditions))},dependencies:[l.MD,l.YU,l.Sq,l.bT],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;height:100%;margin-bottom:.5em}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;padding-left:10px}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .icon.range[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .icon.range[_ngcontent-%COMP%]{width:40px;margin-left:5px}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]{position:relative;cursor:pointer;margin:5px;width:35px;height:35px}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:100%;height:100%}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.active):not(.immune), .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.active):not(.immune){opacity:.5;filter:brightness(50%)}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-element.is-immune[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.immune), .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .condition-element.is-immune[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.immune){opacity:.5;filter:brightness(50%)}.container[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]   .icon.immune[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buffs[_ngcontent-%COMP%]   .condition-element[_ngcontent-%COMP%]   .icon.immune[_ngcontent-%COMP%]{position:absolute;bottom:-2px;right:-2px;width:16px;height:16px;opacity:1;filter:none;pointer-events:none}"]})}return o})();var O=p(7473);const lt=(o,c)=>[o,c];function dt(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",4)(1,"input",5),t.bIt("blur",function(n){s.eBV(e);const i=t.XpG();return s.Njj(i.updateStandee(i.creature.id,i.creature.type,+n.target.value))}),t.k0s(),t.j41(2,"div",6)(3,"div",7)(4,"input",8),t.bIt("blur",function(n){s.eBV(e);const i=t.XpG();return s.Njj(i.updateCreatureHp(i.creature.id,+n.target.value))}),t.k0s()(),t.j41(5,"app-conditions",9),t.bIt("conditionToggled",function(n){s.eBV(e);const i=t.XpG();return s.Njj(i.toggleCondition(n))}),t.k0s()()()}if(2&o){const e=t.XpG();t.R7$(),t.Y8G("value",e.creature.standee),t.R7$(3),t.Y8G("value",e.creature.hp),t.R7$(),t.Y8G("creature",e.creature)("conditions",e.creature.conditions)}}function pt(o,c){if(1&o&&(t.j41(0,"div",11),t.EFF(1),t.k0s()),2&o){const e=c.$implicit,r=t.XpG(2);t.xc7("background","var(--"+r.creature.type+"-color)"),t.R7$(),t.SpI(" ",e," ")}}function ut(o,c){if(1&o&&(t.j41(0,"div",10)(1,"div",11),t.EFF(2),t.k0s(),t.DNE(3,pt,2,3,"div",12),t.k0s()),2&o){const e=t.XpG();t.R7$(2),t.SpI(" ",e.creature.name," "),t.R7$(),t.Y8G("ngForOf",e.creature.traits)}}function gt(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",13),t.bIt("click",function(){s.eBV(e);const n=t.XpG();return s.Njj(n.openConditionModal())}),t.nrm(1,"div",14),t.EFF(2,"Attack "),t.k0s()}}let mt=(()=>{class o{appContext;notificationService;creature;constructor(e,r){this.appContext=e,this.notificationService=r}openConditionModal(){this.appContext.selectedCreature=this.creature,this.appContext.isGroupSelected=!1}toggleCondition(e){this.creature&&this.appContext.toggleCreatureConditions(this.creature.id,e)}updateCreatureHp(e,r){const n=this.appContext.findCreature(e),i=Math.min(r,n.maxHp);this.appContext.updateCreatureBaseStat(e,"hp",i),i<=0&&this.appContext.killCreature(e)}updateStandee(e,r,n){this.appContext.updateCreatureBaseStat(e,"standee",n),this.appContext.updateCreatureBaseStat(e,"name",`${r} - ${n}`)}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B),t.rXU(O.J))};static \u0275cmp=t.VBU({type:o,selectors:[["app-creature"]],inputs:{creature:"creature"},decls:6,vars:9,consts:[["traitsBlock",""],[1,"container",3,"ngClass"],["class","creature-standee stat",4,"ngIf","ngIfElse"],["class","open-modal button attack",3,"click",4,"ngIf"],[1,"creature-standee","stat"],["type","tel","maxlength","2",1,"stat-input","initiative",3,"blur","value"],[1,"header","stat"],[1,"icon","heart"],["type","tel","maxlength","3",1,"stat-input",3,"blur","value"],[3,"conditionToggled","creature","conditions"],[1,"creature-traits"],[1,"trait"],["class","trait",3,"background",4,"ngFor","ngForOf"],[1,"open-modal","button","attack",3,"click"],[1,"icon","attack"]],template:function(r,n){if(1&r&&(t.j41(0,"div")(1,"div",1),t.DNE(2,dt,6,4,"div",2)(3,ut,4,2,"ng-template",null,0,t.C5r),t.k0s(),t.DNE(5,gt,3,0,"button",3),t.k0s()),2&r){const i=t.sdS(4);t.R7$(),t.HbH(n.creature.type),t.Y8G("ngClass",t.l_i(6,lt,n.creature.boss?"boss":n.creature.isElite?"elite":"non-elite",n.creature.aggressive?"":"friendly")),t.R7$(),t.Y8G("ngIf",n.creature.aggressive)("ngIfElse",i),t.R7$(3),t.Y8G("ngIf",n.creature.aggressive)}},dependencies:[l.MD,l.YU,l.Sq,l.bT,C.S,m.YN,T],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;background:var(--nonelite-color);flex-direction:column;width:100%}.container.elite[_ngcontent-%COMP%]{background:var(--elite-color)}.container.friendly[_ngcontent-%COMP%]{background-color:var(--background-color)}.container.boss[_ngcontent-%COMP%]{background-color:var(--boss-color)}.container[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{border:none;background-color:var(--base-color-spots);border-radius:0 30px 30px 0;line-height:20px;font-size:20px;height:25px}.creature-traits[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;font-size:1rem;width:100%}.creature-traits[_ngcontent-%COMP%]   .trait[_ngcontent-%COMP%]{text-align:center;-webkit-user-select:none;user-select:none}input[_ngcontent-%COMP%]{background:none;color:var(--font-color)}.creature-standee[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:60px}.header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;align-items:center}.header[_ngcontent-%COMP%]   .icon.heart[_ngcontent-%COMP%]{width:60px;height:60px;justify-content:center}.header[_ngcontent-%COMP%]   .icon.heart[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#fff;width:100%;height:100%;font-size:20px;box-sizing:border-box;border:none}button.open-modal[_ngcontent-%COMP%]{display:flex;width:100%;border-radius:0;border:0;border-top:1px solid;border-bottom:3px solid;justify-content:center;font-size:20px;background-color:var(--attack-button-color)}button.open-modal[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-right:10px;width:24px;height:24px}@media (max-width: 768px){.container[_ngcontent-%COMP%], .creature-standee[_ngcontent-%COMP%]{justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{border-radius:30px}}"]})}return o})();function _t(o,c){if(1&o&&(t.j41(0,"div",7),t.nrm(1,"app-creature",4),t.k0s()),2&o){const e=c.$implicit;t.Y8G("ngClass",e.type),t.R7$(),t.Y8G("creature",e)}}function ft(o,c){if(1&o&&(t.j41(0,"div",2)(1,"div",3),t.nrm(2,"app-creature-group-header",4),t.j41(3,"div",5),t.DNE(4,_t,2,2,"div",6),t.k0s()()()),2&o){const e=c.$implicit;t.Y8G("ngClass",e.creatureType.aggressive?"":"friendly"),t.R7$(2),t.Y8G("creature",e.creatureType),t.R7$(2),t.Y8G("ngForOf",e.creatures)}}let Ct=(()=>{class o{appContext;groupedCreatures=[];groupedGraveyard=[];unsubscribe$=new b.B;creatureHpInputs={};constructor(e){this.appContext=e,this.sortCreatures(),this.sortGraveyard(),this.appContext.creatures$.pipe((0,v.Q)(this.unsubscribe$)).subscribe(r=>{this.sortCreatures()}),this.appContext.graveyard$.pipe((0,v.Q)(this.unsubscribe$)).subscribe(r=>{this.sortGraveyard()})}sortCreatures(){const e={};for(const r of this.appContext.getCreatures()){const n=`${r.type}-${r.isElite}`;e[n]||(e[n]=[]),e[n].push(r)}this.groupedCreatures=Object.keys(e).map(r=>({type:r,creatureType:e[r][0],creatures:[...e[r]].sort((n,i)=>{const a=Number(n.standee),d=Number(i.standee);return(Number.isNaN(a)?Number.POSITIVE_INFINITY:a)-(Number.isNaN(d)?Number.POSITIVE_INFINITY:d)})}))}get sortedCreatureGroups(){return[...this.groupedCreatures].sort((e,r)=>{const n=e.creatureType,i=r.creatureType;if((n.initiative??0)!==(i.initiative??0))return(n.initiative??0)-(i.initiative??0);if(n.aggressive!==i.aggressive)return n.aggressive?1:-1;const a=(n.type||"").toLowerCase(),d=(i.type||"").toLowerCase();if(a<d)return-1;if(a>d)return 1;if(n.isElite!==i.isElite)return n.isElite?-1:1;const u=n.standee??0,f=i.standee??0;return u<f?-1:u>f?1:0})}sortGraveyard(){const e={};for(const r of this.appContext.getCreatures()){const n=`${r.type}-${r.isElite}`;e[n]||(e[n]=[]),e[n].push(r)}this.groupedGraveyard=Object.keys(e).map(r=>({type:r,creatureType:e[r][0],creatures:e[r]}))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-game"]],decls:2,vars:1,consts:[[1,"game-container"],["class","creature-group",3,"ngClass",4,"ngFor","ngForOf"],[1,"creature-group",3,"ngClass"],[1,"creature-container"],[3,"creature"],[1,"creature-list"],["class","creature",3,"ngClass",4,"ngFor","ngForOf"],[1,"creature",3,"ngClass"]],template:function(r,n){1&r&&(t.j41(0,"div",0),t.DNE(1,ft,5,3,"div",1),t.k0s()),2&r&&(t.R7$(),t.Y8G("ngForOf",n.sortedCreatureGroups))},dependencies:[l.MD,l.YU,l.Sq,m.YN,ot,mt],styles:[".game-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;flex-direction:row;gap:.3rem;flex-wrap:wrap}.game-container[_ngcontent-%COMP%]   .creature-group[_ngcontent-%COMP%]{border:1px solid;border-color:var(--font-color);flex-grow:1}.game-container[_ngcontent-%COMP%]   .creature-group.friendly[_ngcontent-%COMP%]{flex-basis:0%}.game-container[_ngcontent-%COMP%]   .creature-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;gap:.5rem;justify-content:flex-start}.game-container[_ngcontent-%COMP%]   .creature-container[_ngcontent-%COMP%]   .creature-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem;flex-wrap:nowrap;width:100%}.game-container[_ngcontent-%COMP%]   .creature-container[_ngcontent-%COMP%]   .creature-list[_ngcontent-%COMP%]   .creature[_ngcontent-%COMP%]{width:100%;border:1px solid;border-color:var(--font-color)}@media (max-width: 768px){.game-container[_ngcontent-%COMP%]   .creature-container[_ngcontent-%COMP%]{max-width:none;width:100%}.game-container[_ngcontent-%COMP%]   .creature-list[_ngcontent-%COMP%]{flex-direction:column!important}}"]})}return o})();var g=p(8880);const ht=(o,c)=>[o,c];function vt(o,c){if(1&o&&(s.qSk(),t.nrm(0,"path",11)),2&o){const e=c.$implicit,r=t.XpG();t.Y8G("ngClass",t.l_i(2,ht,r.element.type,r.element.state)),t.BMQ("d",e)}}let Mt=(()=>{class o{appContext;element;constructor(e){this.appContext=e}symbols={fire:{transform:"matrix(0.35277777,0,0,-0.35277777,129.1384,74.102455)",d:["m 0,0 c -42.5,34.5 -58.5,99.5 -47,143.5 -25.5,-2.5 -66.272,-25.288 -83.5,-89.5 -22,-82 43.996,-140.5 0,-170.5 -51.444,-35.079 -86.5,26 -82,82.5 -30,-23.5 -48.447,-119.579 -9.5,-178 28,-42 63.811,-66.136 109.516,-71.391 -14.745,10.442 -15.741,29.913 -10.516,44.891 7.5,21.5 32.239,31.107 55.5,49 26,20 37,40 38.5,49.5 13,-19.5 28.581,-48.317 15.5,-91 -6.013,-19.62 -16.979,-38.34 -34.339,-49.45 C 7.137,-266.249 71.825,-218.559 72,-134.5 72.156,-59.5 34.135,-27.709 0,0"]},ice:{transform:"matrix(0.35277777,0,0,-0.35277777,98.77778,114.17392)",d:["M 0,0 -37.729,21.782 V 65.349 L 0,87.132 37.729,65.349 V 21.782 Z m 182.664,-2.602 -38.139,-27.986 -30.576,18.524 49.5,34.673 c 3.166,2.218 3.935,6.583 1.717,9.75 -2.219,3.165 -6.582,3.936 -9.75,1.717 L 100.863,-4.137 51.729,25.63 v 35.871 l 49.135,29.768 54.552,-38.214 c 1.223,-0.856 2.623,-1.267 4.011,-1.267 2.206,0 4.377,1.04 5.739,2.984 2.218,3.166 1.449,7.532 -1.717,9.749 l -49.499,34.675 30.575,18.524 38.139,-27.987 c 1.248,-0.916 2.698,-1.357 4.136,-1.357 2.153,0 4.278,0.99 5.649,2.859 2.287,3.118 1.614,7.498 -1.502,9.786 l -33.459,24.552 29.336,17.773 c 3.348,1.932 4.495,6.214 2.563,9.562 -1.933,3.348 -6.213,4.496 -9.563,2.562 l -30.065,-16.465 -4.529,41.199 c -0.421,3.844 -3.881,6.621 -7.722,6.193 -3.843,-0.422 -6.616,-3.879 -6.194,-7.722 l 5.161,-46.945 -31.334,-17.159 -5.268,60.069 c -0.338,3.85 -3.711,6.71 -7.585,6.361 -3.851,-0.337 -6.699,-3.733 -6.362,-7.584 L 91.729,107.227 41.16,79.534 10.482,97.246 9.212,154.965 69.49,183.06 c 3.504,1.632 5.021,5.797 3.388,9.301 -1.633,3.503 -5.796,5.022 -9.302,3.388 L 8.875,170.254 8.088,205.979 51.35,224.996 c 3.54,1.556 5.147,5.686 3.591,9.225 -1.556,3.538 -5.686,5.148 -9.224,3.591 L 7.755,221.125 7,255.404 c 0,3.867 -3.134,7 -7,7 -3.866,0 -7,-3.133 -7,-7 l -0.746,-34.282 -37.972,16.69 c -3.538,1.557 -7.67,-0.053 -9.224,-3.591 -1.556,-3.539 0.051,-7.669 3.591,-9.225 l 43.276,-19.022 -0.778,-35.73 -54.724,25.505 c -3.506,1.633 -7.668,0.116 -9.302,-3.388 -1.633,-3.504 -0.116,-7.669 3.388,-9.301 L -9.186,154.953 -10.439,97.27 -41.15,79.54 l -50.579,27.694 5.802,66.183 c 0.337,3.851 -2.51,7.247 -6.362,7.584 -3.858,0.347 -7.248,-2.511 -7.585,-6.361 l -5.266,-60.063 -31.334,17.157 5.159,46.941 c 0.422,3.843 -2.351,7.301 -6.194,7.722 -3.83,0.425 -7.3,-2.349 -7.722,-6.193 l -4.528,-41.196 -30.065,16.463 c -3.348,1.932 -7.629,0.785 -9.563,-2.563 -1.932,-3.347 -0.785,-7.629 2.563,-9.561 l 29.336,-17.773 -33.46,-24.553 c -3.116,-2.288 -3.789,-6.668 -1.502,-9.785 1.371,-1.869 3.496,-2.859 5.649,-2.859 1.438,0 2.888,0.441 4.136,1.356 l 38.14,27.987 30.575,-18.524 -49.5,-34.675 c -3.166,-2.217 -3.935,-6.583 -1.717,-9.749 1.362,-1.944 3.533,-2.984 5.739,-2.984 1.387,0 2.788,0.411 4.011,1.267 L -100.864,91.269 -51.729,61.5 V 26.002 l -49.316,-30.013 -54.373,38.087 c -3.164,2.219 -7.529,1.449 -9.749,-1.718 -2.218,-3.166 -1.449,-7.531 1.718,-9.749 l 49.346,-34.566 -30.509,-18.567 -38.053,27.922 c -3.118,2.289 -7.499,1.614 -9.785,-1.502 -2.287,-3.117 -1.614,-7.498 1.502,-9.785 l 33.399,-24.508 -29.275,-17.817 c -3.348,-1.933 -4.495,-6.215 -2.563,-9.562 1.297,-2.246 3.65,-3.501 6.07,-3.501 1.187,0 2.39,0.302 3.493,0.938 l 30.057,16.537 4.536,-41.27 c 0.393,-3.583 3.425,-6.237 6.949,-6.237 0.256,0 0.513,0.015 0.773,0.043 3.843,0.422 6.616,3.88 6.194,7.723 l -5.17,47.048 31.329,17.236 5.282,-60.249 c 0.319,-3.643 3.376,-6.388 6.966,-6.388 0.204,0 0.411,0.008 0.619,0.026 3.852,0.338 6.699,3.733 6.362,7.585 l -5.821,66.402 50.276,27.66 30.91,-17.845 1.299,-57.635 -60.228,-28.071 c -3.504,-1.633 -5.021,-5.798 -3.388,-9.302 1.188,-2.548 3.712,-4.045 6.35,-4.045 0.989,0 1.996,0.212 2.952,0.657 l 54.659,25.476 0.805,-35.717 -43.238,-19.006 c -3.54,-1.556 -5.147,-5.685 -3.591,-9.225 1.153,-2.623 3.719,-4.185 6.412,-4.185 0.94,0 1.896,0.191 2.812,0.594 l 37.946,16.679 0.772,-34.271 c 0,-3.866 3.134,-7 7,-7 3.866,0 7,3.134 7,7 l 0.729,34.291 37.988,-16.699 c 0.916,-0.404 1.872,-0.594 2.812,-0.594 2.693,0 5.26,1.562 6.412,4.185 1.556,3.54 -0.051,7.669 -3.59,9.225 l -43.301,19.034 0.759,35.739 54.767,-25.526 c 0.957,-0.446 1.962,-0.657 2.952,-0.657 2.637,0 5.162,1.497 6.35,4.045 1.633,3.504 0.116,7.669 -3.388,9.302 l -60.356,28.13 1.22,57.456 30.797,17.781 50.578,-27.695 -5.803,-66.183 c -0.337,-3.852 2.511,-7.247 6.362,-7.585 0.208,-0.018 0.414,-0.026 0.619,-0.026 3.59,0 6.646,2.745 6.966,6.388 l 5.267,60.064 31.333,-17.158 -5.159,-46.941 c -0.422,-3.843 2.351,-7.301 6.194,-7.723 0.26,-0.028 0.517,-0.043 0.773,-0.043 3.523,0 6.556,2.654 6.949,6.237 l 4.528,41.197 30.066,-16.464 c 1.103,-0.636 2.306,-0.938 3.493,-0.938 2.419,0 4.773,1.256 6.07,3.501 1.932,3.347 0.785,7.629 -2.563,9.562 l -29.336,17.773 33.459,24.552 c 3.116,2.287 3.789,6.668 1.502,9.785 -2.286,3.117 -6.667,3.791 -9.785,1.502"]},earth:{transform:"matrix(0.35277777,0,0,-0.35277777,60.624366,132.24034)",d:["m 0,0 c -0.423,-4 -4.892,-6.179 -8.264,-3.987 -24.283,15.779 -85.571,80.677 -11.571,162.809 73.487,81.563 169.567,37.861 265.702,95.873 2.907,1.755 6.665,0.165 7.401,-3.15 13.134,-59.172 20.961,-187.976 -39.103,-247.223 -73.5,-72.5 -133.5,-40.5 -166,-29 -1.5,-18 4.501,-41.921 9.501,-58.421 5,-16.5 -27.001,-21.079 -31.001,-18.079 -4,3 -18.611,83.753 18.5,133 47.5,63.032 163,118 166.5,162.5 -22.5,-20 -51.809,-46.518 -129,-89.5 C 14.221,66.711 2.036,19.224 0,0"]},air:{transform:"",d:["m 20.688488,108.37995 c -0.487826,-0.10197 -0.465777,-0.80891 0.02756,-0.87368 4.4111,-0.5898 15.013728,-0.97289 28.807886,5.52594 18.344445,8.64305 47.966756,27.9535 65.510566,26.90481 14.83458,-0.88745 22.05963,-6.46575 21.27277,-13.32287 -0.61736,-5.37986 -6.61458,-8.90764 -11.20069,-7.14375 -4.58611,1.76389 -6.61458,5.90903 -6.26181,9.78958 -3.88055,-2.99861 -2.46944,-8.81944 -1.23472,-10.40694 1.23472,-1.5875 8.00503,-10.8176 19.57917,-2.82222 9.70139,6.70278 5.60035,19.76106 0,24.69444 -3.70417,3.2632 -14.81667,11.46528 -35.80695,6.17361 -20.990276,-5.29166 -43.620421,-24.4588 -55.562499,-30.1625 -10.991233,-5.24895 -15.72617,-6.37893 -25.131284,-8.35642","m 52.230405,106.05382 c -0.343133,-0.18741 -0.126781,-0.70969 0.246669,-0.59531 7.845171,2.39503 27.789516,6.9081 42.202418,3.16397 21.048158,-5.46805 24.870838,-17.991663 45.861108,-28.162962 13.38765,-6.487806 30.86806,-1.823145 35.63056,11.229631 4.7625,13.052781 -7.64398,22.048611 -17.4625,21.519451 -8.10424,-0.43547 -13.57919,-5.06429 -14.64028,-8.82634 -1.17684,-4.16719 0.46991,-9.575991 5.29167,-11.105611 -1.41111,6.35 2.04087,13.292561 9.17222,12.876391 7.05556,-0.41065 13.28704,-9.250771 6.70278,-15.875001 -6.59529,-6.633877 -14.81667,-5.349543 -19.75556,-2.293055 -5.26686,3.260439 -17.63889,15.522226 -28.22222,20.637496 -10.15752,4.90858 -25.033443,10.26501 -40.41648,6.17362 -13.106524,-3.48368 -17.129016,-4.64675 -24.610385,-8.74228","m 32.342558,94.131028 c -0.445107,-0.170869 -0.305926,-0.83646 0.170875,-0.81717 6.042699,0.24529 22.947094,-0.0317 31.82717,-9.914986 10.936111,-12.170834 8.445997,-20.473515 18.168056,-29.280556 6.790972,-6.150183 22.320081,-8.109755 33.249301,1.234722 12.17084,10.406945 5.70233,30.721985 -6.38031,36.98379 -10.23056,5.30131 -23.07663,3.58565 -25.987047,-4.704623 -3.241146,-9.231477 3.439583,-17.374306 10.230556,-17.286111 7.161661,0.0937 6.173611,7.231944 6.173611,7.231944 0,0 -2.11667,-3.701411 -5.027083,-3.263194 -3.689008,0.556725 -6.943934,5.177289 -5.027084,9.789583 2.38125,5.732639 12.621457,8.270981 19.989817,-0.46991 7.58473,-8.995834 5.93935,-21.225923 -6.58426,-25.635646 -11.575522,-4.074858 -18.36236,4.462089 -24.518057,15.877756 -4.850694,8.993078 -10.31875,20.458351 -26.9875,21.418851 -12.219065,0.7028 -16.949868,-0.26321 -19.298045,-1.16445"]},light:{transform:"matrix(0.35277777,0,0,-0.35277777,141.35502,111.71516)",d:["m 0,0 -9.044,27.255 23.505,9.418 -23.504,9.418 9.042,27.252 61.997,-36.673 z m 8.504,-92.473 -69.776,17.889 12.869,25.65 23.279,-9.961 -9.961,23.28 25.675,12.882 z m -129.142,-53.492 -36.693,61.957 27.222,9.032 9.418,-23.503 9.417,23.503 27.262,-9.045 z m -129.142,53.492 17.848,69.718 25.633,-12.86 -9.96,-23.28 23.279,9.961 12.875,-25.661 z m -53.492,129.143 61.897,36.648 9.034,-27.228 -23.504,-9.417 23.504,-9.417 -9.035,-27.232 z m 53.492,129.142 69.674,-17.875 -12.874,-25.658 -23.279,9.961 9.96,-23.279 -25.634,-12.86 z m 129.142,53.493 36.625,-61.939 -27.26,-9.046 -9.418,23.505 -9.418,-23.505 -27.221,9.033 z m 66.4,-155.106 14.078,32.9 26.922,-15.926 -7.78,-30.284 z m 0,-55.053 33.22,13.311 7.78,-30.287 -26.922,-15.924 z m -38.928,-38.927 32.902,-14.078 -15.909,-26.906 -30.302,7.769 z m -55.052,0 13.31,-33.217 -30.267,-7.766 -15.936,26.909 z m -38.927,38.927 -14.076,-32.895 -26.889,15.92 7.753,30.283 z m 0,55.053 -33.212,-13.307 -7.753,30.281 26.889,15.921 z m 38.927,38.928 -32.893,14.074 15.935,26.906 30.267,-7.764 z m 55.052,0 -13.308,33.213 30.302,7.767 15.908,-26.902 z m 101.67,62.685 -17.913,-69.733 -25.676,12.882 9.961,23.279 -23.279,-9.961 -12.868,25.648 z M 98.306,42.036 5.124,88.788 37.955,187.735 c 0.715,2.155 0.153,4.528 -1.452,6.132 -1.605,1.605 -3.98,2.171 -6.132,1.452 l -98.947,-32.831 -46.752,93.183 c -1.019,2.029 -3.094,3.309 -5.363,3.309 -2.27,0 -4.345,-1.28 -5.364,-3.309 l -46.752,-93.183 -98.947,32.831 c -2.153,0.718 -4.528,0.153 -6.132,-1.452 -1.605,-1.604 -2.167,-3.977 -1.452,-6.132 l 32.83,-98.948 -93.181,-46.751 c -2.03,-1.018 -3.31,-3.094 -3.31,-5.363 0,-2.27 1.28,-4.345 3.31,-5.363 l 93.181,-46.751 -32.83,-98.949 c -0.715,-2.154 -0.153,-4.527 1.452,-6.131 1.605,-1.605 3.978,-2.169 6.132,-1.453 l 98.947,32.831 46.752,-93.182 c 1.019,-2.029 3.094,-3.31 5.364,-3.31 2.269,0 4.344,1.281 5.363,3.31 l 46.751,93.182 98.948,-32.831 c 0.619,-0.206 1.257,-0.305 1.889,-0.305 1.566,0 3.1,0.614 4.243,1.758 1.605,1.604 2.167,3.977 1.452,6.131 L 5.123,-15.442 98.306,31.31 c 2.029,1.018 3.309,3.093 3.309,5.363 0,2.269 -1.28,4.345 -3.309,5.363"]},dark:{transform:"matrix(0.35277777,0,0,-0.35277777,114.94562,150.20756)",d:["m 0,0 c -8.87,0 -17.561,0.8 -26,2.32 6.06,2.781 11.92,5.941 17.54,9.441 1.786,1.112 3.539,2.271 5.276,3.453 73.09,1.203 131.963,59.194 131.963,130.566 0,71.385 -58.877,129.378 -131.971,130.577 -1.739,1.181 -3.492,2.34 -5.279,3.454 -5.619,3.5 -11.469,6.659 -17.529,9.439 8.439,1.521 17.13,2.32 26,2.32 80.38,0 145.779,-65.4 145.779,-145.79 C 145.779,65.4 80.38,0 0,0 M -45.83,7.38 C -52.25,5.24 -58.88,3.55 -65.66,2.32 -74.1,0.8 -82.78,0 -91.65,0 c -80.39,0 -145.79,65.4 -145.79,145.78 0,80.39 65.4,145.79 145.79,145.79 8.87,0 17.55,-0.799 25.99,-2.32 6.78,-1.229 13.41,-2.92 19.83,-5.06 6.019,-1.99 11.87,-4.379 17.51,-7.11 48.75,-23.61 82.45,-73.59 82.45,-131.3 0,-57.7 -33.7,-107.679 -82.45,-131.29 -5.64,-2.729 -11.491,-5.12 -17.51,-7.11 M 0,303.57 c -15.93,0 -31.311,-2.37 -45.82,-6.79 -14.51,4.42 -29.901,6.79 -45.83,6.79 -87.01,0 -157.79,-70.78 -157.79,-157.79 0,-87 70.78,-157.78 157.79,-157.78 15.929,0 31.32,2.37 45.83,6.79 C -31.311,-9.63 -15.93,-12 0,-12 87,-12 157.779,58.78 157.779,145.78 157.779,232.79 87,303.57 0,303.57"]}};ngOnInit(){this.appContext.elements$.subscribe(e=>{const r=e.find(n=>n.type===this.element.type);r&&(this.element={...r})})}get fillUrl(){return`url(#${this.element.type}-${this.element.state})`}toggleColor(){const e=this.element.state===g.e_.None?g.e_.Full:this.element.state===g.e_.Full?g.e_.Half:g.e_.None;this.appContext.setElementState(this.element.type,e),this.element={...this.element,state:e}}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-element"]],inputs:{element:"element"},decls:15,vars:14,consts:[[1,"element-container"],["viewBox","0 0 197.55556 197.55556","xmlns","http://www.w3.org/2000/svg",1,"element-icon",3,"click"],["x1","0%","y1","100%","x2","0%","y2","0%"],["offset","50%",2,"stop-opacity","0.75"],["x1","0%","y1","100%"],["offset","190%",2,"stop-opacity","1"],["d","m 98.77778,194.73333 c -25.630363,0 -49.727202,-9.98114 -67.850807,-28.10475 C 12.803368,148.50498 2.8222266,124.40814 2.8222266,98.777777 2.8222266,73.14706 12.803368,49.050575 30.926973,30.92697 49.050578,12.803365 73.147417,2.8222231 98.77778,2.8222231 c 25.63036,0 49.7272,9.9811419 67.85081,28.1047469 18.1236,18.123605 28.10474,42.22009 28.10474,67.850807 0,25.630363 -9.98114,49.727203 -28.10474,67.850803 -18.12361,18.12361 -42.22045,28.10475 -67.85081,28.10475"],["transform","matrix(0.35277777,0,0,-0.35277777,98.77778,1.9e-6)",1,"outline"],["d","m 0,0 c -37.793,0 -74.464,-7.405 -108.993,-22.01 -33.345,-14.104 -63.287,-34.291 -88.997,-60 -25.709,-25.71 -45.897,-55.652 -59.999,-88.996 C -272.595,-205.537 -280,-242.207 -280,-280 c 0,-37.793 7.405,-74.464 22.011,-108.993 14.102,-33.345 34.29,-63.287 59.999,-88.997 25.71,-25.709 55.652,-45.897 88.997,-59.999 C -74.464,-552.595 -37.793,-560 0,-560 c 37.793,0 74.464,7.405 108.993,22.011 33.345,14.102 63.287,34.29 88.997,59.999 25.709,25.71 45.897,55.652 59.999,88.997 14.606,34.529 22.011,71.2 22.011,108.993 0,37.793 -7.405,74.463 -22.011,108.994 -14.102,33.344 -34.29,63.286 -59.999,88.996 -25.71,25.709 -55.652,45.896 -88.997,60 C 74.464,-7.405 37.793,0 0,0 m 0,-16 c 145.803,0 264,-118.197 264,-264 0,-145.803 -118.197,-264 -264,-264 -145.803,0 -264,118.197 -264,264 0,145.803 118.197,264 264,264",2,"fill-opacity","1","fill-rule","nonzero","stroke","none"],[1,"symbol"],["style","fill-opacity:1;fill-rule:nonzero;stroke:none",3,"ngClass",4,"ngFor","ngForOf"],[2,"fill-opacity","1","fill-rule","nonzero","stroke","none",3,"ngClass"]],template:function(r,n){1&r&&(t.j41(0,"div",0),s.qSk(),t.j41(1,"svg",1),t.bIt("click",function(){return n.toggleColor()}),t.j41(2,"defs")(3,"linearGradient",2),t.nrm(4,"stop",3)(5,"stop",3),t.k0s(),t.j41(6,"linearGradient",4),t.nrm(7,"stop",5),t.k0s(),t.j41(8,"linearGradient",4),t.nrm(9,"stop",5),t.k0s()(),t.nrm(10,"path",6),t.j41(11,"g",7),t.nrm(12,"path",8),t.k0s(),t.j41(13,"g",9),t.DNE(14,vt,1,5,"path",10),t.k0s()()()),2&r&&(t.R7$(3),t.BMQ("id",n.element.type+"-half"),t.R7$(),t.xc7("stop-color","var(--element-"+n.element.type+"-color)"),t.R7$(),t.xc7("stop-color","var(--element-base-color)"),t.R7$(),t.BMQ("id",n.element.type+"-full"),t.R7$(),t.xc7("stop-color","var(--element-"+n.element.type+"-color)"),t.R7$(),t.BMQ("id",n.element.type+"-none"),t.R7$(),t.xc7("stop-color","var(--element-base-color)"),t.R7$(),t.BMQ("fill",n.fillUrl),t.R7$(3),t.BMQ("transform",n.symbols[n.element.type].transform),t.R7$(),t.Y8G("ngForOf",n.symbols[n.element.type].d))},dependencies:[l.MD,l.YU,l.Sq],styles:[".element-container[_ngcontent-%COMP%]{width:50px;height:50px;display:flex;gap:8px}svg[_ngcontent-%COMP%]{background-color:var(--content-background-right);border-radius:50%}svg[_ngcontent-%COMP%]   stop[_ngcontent-%COMP%]{transition:.4s ease}svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:var(--font-color-dark)}svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   path.dark.full[_ngcontent-%COMP%]{fill:var(--element-base-color)}.element[_ngcontent-%COMP%]{width:100%;height:100%;transform-origin:center;display:block}"]})}return o})(),$=(()=>{class o{appContext;creature;buffs=[];constructor(e){this.appContext=e}storeBuff(e,r){this.buffs.push({type:e,value:r})}publishBuffs(){this.buffs.forEach(e=>{this.appContext.updateCreatureBaseStat(this.creature.id,e.type,e.value,!0)})}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-buffs"]],inputs:{creature:"creature"},decls:19,vars:4,consts:[[1,"buffs"],[1,"stats","base-stats"],[1,"armor","stat"],[1,"icon","shield"],["type","tel","maxlength","3",1,"stat-input",3,"blur","value"],[1,"retaliate","stat"],[1,"icon","retaliate"],[1,"stats","round-stats"]],template:function(r,n){1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"div"),t.EFF(3,"Base"),t.k0s(),t.j41(4,"div",2),t.nrm(5,"div",3),t.j41(6,"input",4),t.bIt("blur",function(a){return n.storeBuff("armor",+a.target.value)}),t.k0s()(),t.j41(7,"div",5),t.nrm(8,"div",6),t.j41(9,"input",4),t.bIt("blur",function(a){return n.storeBuff("retaliate",+a.target.value)}),t.k0s()()(),t.j41(10,"div",7)(11,"div"),t.EFF(12,"Round"),t.k0s(),t.j41(13,"div",2),t.nrm(14,"div",3),t.j41(15,"input",4),t.bIt("blur",function(a){return n.storeBuff("roundArmor",+a.target.value)}),t.k0s()(),t.j41(16,"div",5),t.nrm(17,"div",6),t.j41(18,"input",4),t.bIt("blur",function(a){return n.storeBuff("roundRetaliate",+a.target.value)}),t.k0s()()()()),2&r&&(t.R7$(6),t.Y8G("value",n.creature.armor),t.R7$(3),t.Y8G("value",n.creature.retaliate),t.R7$(6),t.Y8G("value",n.creature.roundArmor),t.R7$(3),t.Y8G("value",n.creature.roundRetaliate))},dependencies:[l.MD,C.S],styles:[".buffs[_ngcontent-%COMP%]{font-size:30px;display:flex;flex-direction:column}.buffs[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;margin:5px 0}.buffs[_ngcontent-%COMP%]   .stats.round-stats[_ngcontent-%COMP%]{border-top:5px solid}.buffs[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.buffs[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-input[_ngcontent-%COMP%]{height:40px;line-height:40px}"]})}return o})();function xt(o,c){if(1&o&&t.nrm(0,"app-buffs",10),2&o){const e=t.XpG();t.Y8G("creature",e.creature)}}function Pt(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",12),t.nrm(1,"div",17),t.j41(2,"input",14),t.mxI("ngModelChange",function(n){s.eBV(e);const i=t.XpG(2);return t.DH7(i.armorPen,n)||(i.armorPen=n),s.Njj(n)}),t.bIt("ngModelChange",function(){s.eBV(e);const n=t.XpG(2);return s.Njj(n.calculateDamage())}),t.k0s()()}if(2&o){const e=t.XpG(2);t.R7$(2),t.R50("ngModel",e.armorPen)}}function Ot(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",11)(1,"div",12),t.nrm(2,"div",13),t.j41(3,"input",14),t.mxI("ngModelChange",function(n){s.eBV(e);const i=t.XpG();return t.DH7(i.attack,n)||(i.attack=n),s.Njj(n)}),t.bIt("ngModelChange",function(){s.eBV(e);const n=t.XpG();return s.Njj(n.calculateDamage())}),t.k0s()(),t.DNE(4,Pt,3,1,"div",15),t.j41(5,"div",16),t.EFF(6),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.R50("ngModel",e.attack),t.R7$(),t.Y8G("ngIf",e.creature.armor+e.creature.roundArmor>0),t.R7$(2),t.SpI(" total: ",e.damage||0," ")}}function yt(o,c){if(1&o){const e=t.RV6();t.j41(0,"app-conditions",18),t.bIt("conditionToggled",function(n){s.eBV(e);const i=t.XpG();return s.Njj(i.toggleCondition(n))}),t.k0s()}if(2&o){const e=t.XpG();t.Y8G("creature",e.creature)("conditions",e.conditions)("immunities",e.creature.immunities)("shouldShowBuffs",e.shouldShowBuffs)}}let kt=(()=>{class o{appContext;buffsComponent;creature;conditions=Object.values(g.Mm);attack=0;armorPen=0;damage=0;tempConditions=[];constructor(e){this.appContext=e,this.creature=e.selectedCreature}get shouldShowBuffs(){const{armor:e=0,roundArmor:r=0,retaliate:n=0,roundRetaliate:i=0}=this.creature??{};return e>0||r>0||n>0||i>0}toggleCondition(e){this.tempConditions.push(e)}attackCreature(){if(this.attack<=0)return;const e=this.calculateDamage(),r=this.creature.hp-e;this.appContext.updateCreatureBaseStat(this.creature.id,"hp",this.creature.hp-e),r<=0&&this.appContext.killCreature(this.creature.id)}calculateDamage(){let e=this.attack;const r=Math.max(this.creature.armor+this.creature.roundArmor-this.armorPen,0);e-=r;const n={[g.Mm.poison]:a=>a+1,[g.Mm.brittle]:a=>2*a,[g.Mm.ward]:a=>Math.floor(a/2)};return e=this.creature.conditions.filter(a=>n[a]&&e>0).map(a=>n[a]).reduce((a,d)=>d(a),e),this.damage=Math.max(e,0),this.damage}confirm(){this.attackCreature(),this.tempConditions.forEach(e=>{this.creature&&this.appContext.toggleCreatureConditions(this.creature.id,e)}),this.buffsComponent?.publishBuffs(),this.close()}close(){this.appContext.selectedCreature=null}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-attack-modal"]],viewQuery:function(r,n){if(1&r&&t.GBs($,5),2&r){let i;t.mGM(i=t.lsd())&&(n.buffsComponent=i.first)}},decls:13,vars:4,consts:[[1,"layout"],[1,"modal"],[1,"content"],[1,"name"],[3,"creature",4,"ngIf"],["class","attack",4,"ngIf"],[3,"creature","conditions","immunities","shouldShowBuffs","conditionToggled",4,"ngIf"],[1,"buttons"],["type","button",1,"cancel",3,"click"],["type","button",1,"confirm",3,"click"],[3,"creature"],[1,"attack"],[1,"stat"],[1,"icon","damage"],["type","tel","maxlength","3",1,"stat-input",3,"ngModelChange","ngModel"],["class","stat",4,"ngIf"],[1,"damage-preview"],[1,"icon","pierce"],[3,"conditionToggled","creature","conditions","immunities","shouldShowBuffs"]],template:function(r,n){1&r&&(t.nrm(0,"div",0),t.j41(1,"div",1)(2,"div",2)(3,"div",3),t.EFF(4),t.k0s(),t.DNE(5,xt,1,1,"app-buffs",4)(6,Ot,7,3,"div",5)(7,yt,1,4,"app-conditions",6),t.j41(8,"div",7)(9,"button",8),t.bIt("click",function(){return n.close()}),t.EFF(10,"Cancel"),t.k0s(),t.j41(11,"button",9),t.bIt("click",function(){return n.confirm()}),t.EFF(12,"Confirm"),t.k0s()()()()),2&r&&(t.R7$(4),t.SpI("",n.appContext.isGroupSelected&&n.creature.aggressive?n.creature.type:n.creature.name," "),t.R7$(),t.Y8G("ngIf",n.appContext.isGroupSelected),t.R7$(),t.Y8G("ngIf",!n.appContext.isGroupSelected),t.R7$(),t.Y8G("ngIf",!n.appContext.isGroupSelected))},dependencies:[l.MD,l.bT,T,C.S,$,m.YN,m.me,m.BC,m.tU,m.vS],styles:["[_nghost-%COMP%]{position:fixed;inset:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{box-shadow:0 0 0 3px var(--content-box-shadow-1),0 0 4px 3px var(--content-box-shadow-2),inset 0 0 7px 0 var(--content-box-shadow-3),3px 3px 1px 1px var(--content-box-shadow-4),-3px 3px 1px 1px var(--content-box-shadow-4);padding:15px;gap:.5rem;display:flex;flex-direction:column}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:35px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .damage-preview[_ngcontent-%COMP%]{margin-top:.1em;margin-bottom:.1em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .icon.damage[_ngcontent-%COMP%]{height:55px}"]})}return o})();var S=p(4412),E=p(4572),jt=p(9172),y=p(6354),It=p(8147);function Ft(o,c){if(1&o&&(t.j41(0,"option",13),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.Y8G("value",e.value),t.R7$(),t.JRh(e.text)}}function wt(o,c){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"select",11),t.bIt("change",function(n){s.eBV(e);const i=t.XpG(2);return s.Njj(i.onFilterChange(n))}),t.DNE(2,Ft,2,2,"option",12),t.k0s(),t.bVm()}if(2&o){const e=t.XpG().ngIf;t.R7$(2),t.Y8G("ngForOf",e)}}function Rt(o,c){if(1&o&&(t.j41(0,"div",9),t.DNE(1,wt,3,1,"ng-container",10),t.k0s()),2&o){const e=c.ngIf;t.R7$(),t.Y8G("ngIf",e.length)}}function Tt(o,c){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"button",14),t.bIt("click",function(){const n=s.eBV(e).$implicit,i=t.XpG();return s.Njj(i.undo(n))}),t.k0s()()()}if(2&o){const e=c.$implicit;t.R7$(2),t.JRh(e.time),t.R7$(2),t.JRh(e.creature),t.R7$(2),t.JRh(e.stat),t.R7$(2),t.JRh(e.value)}}function $t(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",15)(1,"button",16),t.bIt("click",function(){const n=s.eBV(e).ngIf,i=t.XpG();return s.Njj(i.prevPage(n))}),t.EFF(2,"Prev"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"button",16),t.bIt("click",function(){const n=s.eBV(e).ngIf,i=t.XpG();return s.Njj(i.nextPage(n))}),t.EFF(6,"Next"),t.k0s()()}if(2&o){const e=c.ngIf,r=t.XpG();t.R7$(),t.Y8G("disabled",1===r.currentPage$.value),t.R7$(3),t.Lme("Page ",r.currentPage$.value," / ",e),t.R7$(),t.Y8G("disabled",r.currentPage$.value===e)}}let St=(()=>{class o{logService;appContext;notificationService;pageSize=10;shouldShowLog=!1;defaultUpdate;undoHandlers;currentPage$=new S.t(1);selectedIds$=new S.t([]);characters$;filteredAll$;totalPages$;filteredLogs$;constructor(e,r,n){this.logService=e,this.appContext=r,this.notificationService=n,this.characters$=this.logService.characterOptions$,this.filteredAll$=(0,E.z)([this.logService.logs$,this.selectedIds$.pipe((0,jt.Z)([]))]).pipe((0,y.T)(([i,a])=>{if(!a||0===a.length)return i;const d=new Set(a);return i.filter(u=>!!u.creatureId&&d.has(u.creatureId))})),this.totalPages$=this.filteredAll$.pipe((0,y.T)(i=>Math.max(1,Math.ceil(i.length/this.pageSize)))),this.filteredLogs$=(0,E.z)([this.filteredAll$,this.currentPage$]).pipe((0,y.T)(([i,a])=>{const d=(a-1)*this.pageSize;return i.slice(d,d+this.pageSize)})),this.defaultUpdate=(i,a,d)=>{if(d.stat){const u=["armor","roundArmor","retaliate","roundRetaliate"].includes(d.stat);this.appContext.updateCreatureBaseStat(i,d.stat,a,u);const h=Array.isArray(a)&&0===a.length?`${d.stat} restored to default`:`${d.stat} restored to ${a}`;this.notificationService.emitInfoMessage(h)}},this.undoHandlers={killed:(i,a,d)=>{const u=this.logService.getLastAliveHpBefore(d.id,i),f=d.data?.old?.hp,h=this.logService.getLastPositiveHp(i);this.appContext.reviveCreature(i,u??(f&&f>0?f:void 0)??h??1)},created:i=>{this.appContext.killCreature&&this.appContext.killCreature(i)}}}onFilterChange(e){const n=Array.from(e.target.selectedOptions).map(i=>i.value);this.currentPage$.next(1),this.selectedIds$.next(n)}prevPage(e){const r=this.currentPage$.value;r>1&&this.currentPage$.next(r-1)}nextPage(e){const r=this.currentPage$.value;r<e&&this.currentPage$.next(r+1)}undo(e){const r=e.creatureId;r&&(this.undoHandlers[e.stat]??this.defaultUpdate)(r,e.oldValue,e)}static \u0275fac=function(r){return new(r||o)(t.rXU(It.K),t.rXU(_.B),t.rXU(O.J))};static \u0275cmp=t.VBU({type:o,selectors:[["app-log"]],decls:27,vars:12,consts:[[1,"log-container"],["tabindex","0","role","button","aria-expanded","false",1,"icon","chevron",3,"click","ngClass"],["viewBox","0 0 24 24","width","24","height","24","stroke","currentColor","stroke-width","2","fill","none","stroke-linecap","round","stroke-linejoin","round"],["points","6 9 12 15 18 9"],[1,"log-content"],["class","log-filter",4,"ngIf"],[1,"log-table"],[4,"ngFor","ngForOf"],["class","pager",4,"ngIf"],[1,"log-filter"],[4,"ngIf"],["multiple","",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"icon","undo",3,"click"],[1,"pager"],[3,"click","disabled"]],template:function(r,n){1&r&&(t.j41(0,"div",0)(1,"h3"),t.EFF(2,"Audit History"),t.k0s(),t.j41(3,"div",1),t.bIt("click",function(){return n.shouldShowLog=!n.shouldShowLog}),s.qSk(),t.j41(4,"svg",2),t.nrm(5,"polyline",3),t.k0s()(),s.joV(),t.j41(6,"div",4),t.DNE(7,Rt,2,1,"div",5),t.nI1(8,"async"),t.j41(9,"table",6)(10,"thead")(11,"tr")(12,"th"),t.EFF(13,"When"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Who"),t.k0s(),t.j41(16,"th"),t.EFF(17,"What"),t.k0s(),t.j41(18,"th"),t.EFF(19,"Is"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Shit"),t.k0s()()(),t.j41(22,"tbody"),t.DNE(23,Tt,11,4,"tr",7),t.nI1(24,"async"),t.k0s()(),t.DNE(25,$t,7,4,"div",8),t.nI1(26,"async"),t.k0s()()),2&r&&(t.R7$(3),t.Y8G("ngClass",n.shouldShowLog?"expanded":""),t.R7$(3),t.xc7("display",n.shouldShowLog?null:"none"),t.R7$(),t.Y8G("ngIf",t.bMT(8,6,n.characters$)),t.R7$(16),t.Y8G("ngForOf",t.bMT(24,8,n.filteredLogs$)),t.R7$(2),t.Y8G("ngIf",t.bMT(26,10,n.totalPages$)))},dependencies:[l.MD,l.YU,l.Sq,l.bT,l.Jj],styles:[".log-container[_ngcontent-%COMP%]{display:block;overflow-x:auto}.log-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}.log-container[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:.5rem}.log-container[_ngcontent-%COMP%]   .log-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:15px;table-layout:fixed}.log-container[_ngcontent-%COMP%]   .log-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .log-container[_ngcontent-%COMP%]   .log-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;text-align:left;border-bottom:1px solid var(--font-color)}.log-container[_ngcontent-%COMP%]   .log-filter[_ngcontent-%COMP%]{width:100%;margin:1rem 0;display:flex;align-items:center;gap:1rem}.log-container[_ngcontent-%COMP%]   .log-filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;font-size:14px;color:var(--font-color)}.log-container[_ngcontent-%COMP%]   .log-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1;min-height:2.5rem;padding:.5rem;border:1px solid var(--font-color);border-radius:6px;font-size:16px;background-color:var(--background-color);color:var(--font-color, #333)}.log-container[_ngcontent-%COMP%]   .log-filter[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{cursor:pointer;padding:6px 10px;font-size:16px}.log-container[_ngcontent-%COMP%]   .log-filter[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:hover{background-color:var(--background-secondary, var(--secondary-color));color:#000}.log-container[_ngcontent-%COMP%]   .pager[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;justify-content:flex-end;margin-top:.5rem;font-size:15px}.log-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--font-color);background-color:var(--background-color);border:1px solid var(--font-color);border-radius:4px;padding:.25rem .75rem;cursor:pointer;font-size:13px}.log-container[_ngcontent-%COMP%]   button.undo[_ngcontent-%COMP%]{border:none;width:20px;height:20px}.log-content[_ngcontent-%COMP%]{display:block}.chevron[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;cursor:pointer;transition:transform .2s ease,color .2s ease;outline:none;color:var(--font-color);border-radius:4px;padding:4px;flex-shrink:0;vertical-align:middle}.chevron.expanded[_ngcontent-%COMP%]{transform:rotate(180deg)}.chevron[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}"]})}return o})();var G=p(130),B=p(5231);function Et(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",20),t.bIt("mousedown",function(n){return s.eBV(e),s.Njj(n.preventDefault())})("click",function(){const n=s.eBV(e).$implicit,i=t.XpG(2);return s.Njj(i.selectMonster(n))}),t.EFF(1),t.k0s()}if(2&o){const e=c.$implicit;t.R7$(),t.SpI(" ",e.name," ")}}function Gt(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",15),t.bIt("click",function(){s.eBV(e);const n=t.XpG();return s.Njj(n.closePicker())}),t.j41(1,"div",16),t.bIt("click",function(n){return s.eBV(e),s.Njj(n.stopPropagation())}),t.j41(2,"button",17),t.bIt("click",function(){s.eBV(e);const n=t.XpG();return s.Njj(n.closePicker())}),t.EFF(3," \u2715 "),t.k0s(),t.j41(4,"div",18),t.DNE(5,Et,2,1,"div",19),t.k0s()()()}if(2&o){const e=t.XpG();t.R7$(5),t.Y8G("ngForOf",e.filteredMonsters)}}let Bt=(()=>{class o{appContext;dataLoader;creatureFactory;notificationService;monsterEvent=new t.bkB;level=1;standee=1;isElite=!1;type="";pickerOpen=!1;monsters=[];filteredMonsters=[];constructor(e,r,n,i){this.appContext=e,this.dataLoader=r,this.creatureFactory=n,this.notificationService=i,this.monsters=this.dataLoader.getData().monsters.sort((a,d)=>a.name.toLowerCase().localeCompare(d.name.toLowerCase())),this.appContext.defaultLevel$.subscribe(a=>{this.level=a})}addMonster(){this.type?(this.appContext.addCreature(this.creatureFactory.createCreature({type:this.type,standee:this.standee,level:this.level,isElite:this.isElite,aggressive:!0})),this.monsterEvent.emit("monster-added"),this.notificationService.emitInfoMessage(`${this.type} added successfully!`)):this.notificationService.emitErrorMessage("Please select a monster type.")}openPicker(){this.pickerOpen=!0,this.filteredMonsters=this.monsters.slice(),document.documentElement.classList.add("no-scroll")}closePicker(){this.pickerOpen=!1,this.filteredMonsters=[],document.documentElement.classList.remove("no-scroll")}onTypeInput(){const e=(this.type||"").toLowerCase().trim();this.filteredMonsters=e?this.monsters.filter(r=>r.name.toLowerCase().includes(e)):this.monsters.slice()}selectMonster(e){this.type=e.name,this.closePicker()}closeModal(){this.appContext.addMonsterToggled=!1}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B),t.rXU(G.X),t.rXU(B.Z),t.rXU(O.J))};static \u0275cmp=t.VBU({type:o,selectors:[["app-add-monster"]],outputs:{monsterEvent:"monsterEvent"},decls:23,vars:4,consts:[[1,"layout"],[1,"modal"],[1,"content"],[1,"title"],[1,"form-row"],["for","type"],["id","type","type","text","autocomplete","off","inputmode","search","autocapitalize","off","autocorrect","off","placeholder","Select\u2026","onfocus","if(this.value) this.value=''",3,"ngModelChange","input","focus","ngModel"],["class","monster-picker-overlay",3,"click",4,"ngIf"],["for","Standee"],["type","tel","placeholder","#",3,"ngModelChange","ngModel"],["for","Elite"],["type","checkbox","id","elite-monster",3,"ngModelChange","ngModel"],[1,"buttons"],["type","button",1,"cancel",3,"click"],["type","button",1,"confirm",3,"click"],[1,"monster-picker-overlay",3,"click"],[1,"monster-picker-sheet",3,"click"],["type","button","aria-label","Close monster picker",1,"picker-close",3,"click"],[1,"monster-type-list"],["class","monster-type-item",3,"mousedown","click",4,"ngFor","ngForOf"],[1,"monster-type-item",3,"mousedown","click"]],template:function(r,n){1&r&&(t.nrm(0,"div",0),t.j41(1,"div",1)(2,"div",2)(3,"div",3),t.EFF(4,"Add Monster"),t.k0s(),t.j41(5,"div",4)(6,"label",5),t.EFF(7,"Type"),t.k0s(),t.j41(8,"input",6),t.mxI("ngModelChange",function(a){return t.DH7(n.type,a)||(n.type=a),a}),t.bIt("input",function(){return n.onTypeInput()})("focus",function(){return n.openPicker()}),t.k0s()(),t.DNE(9,Gt,6,1,"div",7),t.j41(10,"div",4)(11,"label",8),t.EFF(12,"Standee"),t.k0s(),t.j41(13,"input",9),t.mxI("ngModelChange",function(a){return t.DH7(n.standee,a)||(n.standee=a),a}),t.k0s()(),t.j41(14,"div",4)(15,"label",10),t.EFF(16,"Elite"),t.k0s(),t.j41(17,"input",11),t.mxI("ngModelChange",function(a){return t.DH7(n.isElite,a)||(n.isElite=a),a}),t.k0s()(),t.j41(18,"div",12)(19,"button",13),t.bIt("click",function(){return n.closeModal()}),t.EFF(20,"Close"),t.k0s(),t.j41(21,"button",14),t.bIt("click",function(){return n.addMonster()}),t.EFF(22,"Confirm"),t.k0s()()()()),2&r&&(t.R7$(8),t.R50("ngModel",n.type),t.R7$(),t.Y8G("ngIf",n.pickerOpen),t.R7$(4),t.R50("ngModel",n.standee),t.R7$(4),t.R50("ngModel",n.isElite))},dependencies:[l.MD,l.Sq,l.bT,m.YN,m.me,m.Zm,m.BC,m.vS,C.S],styles:[".modal[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.modal[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:root.no-scroll, .modal[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:root.no-scroll   body[_ngcontent-%COMP%]{overflow:hidden;touch-action:none}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;text-align:left}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;text-align:center;width:100%;margin-bottom:1rem;justify-content:center}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   div.form-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   div.form-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100px;font-weight:600;text-align:right}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   div.form-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   div.form-row[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%]{flex:1;margin-bottom:0;width:100%}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   div.form-row[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;vertical-align:middle}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .monster-picker-sheet[_ngcontent-%COMP%]{width:100%;max-width:640px;margin:0 auto;background:var(--background);max-height:50dvh;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 -8px 24px #0000004d}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .monster-type-list[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0;overflow-y:auto;overscroll-behavior:contain;padding:.25rem 0;border-top:none;max-height:none}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .monster-type-item[_ngcontent-%COMP%]{padding:.6rem .8rem;cursor:pointer;-webkit-tap-highlight-color:transparent;border-bottom:1px solid color-mix(in oklab,var(--secondary-color) 40%,transparent)}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .monster-type-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .monster-type-item[_ngcontent-%COMP%]:hover{background:var(--secondary-color)}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .monster-type-item[_ngcontent-%COMP%]:active{transform:translateY(1px)}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .picker-close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;height:40px;min-width:40px;border-radius:8px;border:1px solid var(--secondary-color);color:var(--base-color-spots)}.modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:.5rem;margin-top:1rem}@media (max-width: 768px){.modal[_ngcontent-%COMP%]{top:10%;width:90%}.monster-type-list[_ngcontent-%COMP%]{max-height:45dvh}.monster-picker-overlay[_ngcontent-%COMP%]{place-items:center}.monster-picker-sheet[_ngcontent-%COMP%]{border-radius:16px;max-height:80dvh}}"]})}return o})(),Nt=(()=>{class o{appContext;roundNumber=1;roundAdvanced=new t.bkB;elements=[];sub;constructor(e){this.appContext=e}ngOnInit(){this.sub=this.appContext.roundNumber$.subscribe(e=>{this.roundNumber=e})}ngOnDestroy(){this.sub?.unsubscribe()}nextRound(){this.resetAllCreatures(),this.resetElements();const e=this.roundNumber+1;this.roundNumber=e,this.appContext.setRoundNumber(e),this.roundAdvanced.emit(e)}resetAllCreatures(){const e=this.appContext.getCreatures().map(r=>({...r,initiative:0,roundArmor:0,roundRetaliate:0}));this.appContext.setCreatures(e)}resetElements(){const e=this.appContext.getElements().map(r=>{let n;return n=r.state===g.e_.Half?g.e_.None:r.state===g.e_.Full?g.e_.Half:r.state,{...r,state:n}});this.appContext.setElements(e)}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-round"]],inputs:{elements:"elements"},outputs:{roundAdvanced:"roundAdvanced"},decls:5,vars:1,consts:[[1,"section"],[1,"cancel",3,"click"]],template:function(r,n){1&r&&(t.rj2(0,"div",0)(1,"div"),t.EFF(2),t.eux(),t.rj2(3,"button",1),t.VwU("click",function(){return n.nextRound()}),t.EFF(4," Next "),t.eux()()),2&r&&(t.R7$(2),t.SpI(" Round ",n.roundNumber," "))},dependencies:[l.MD],styles:[".section[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;gap:1rem;align-items:center;border-left:5px solid;padding-left:1rem}.section[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}"]})}return o})();var At=p(467),F=p(4242),Yt=p(3077);let Dt=(()=>{class o{notificationService;storageService;appContext;dataLoader;creatureFactory;webSocketService;scenarioLevel=1;scenarioId;sectionId;sessionId=1;constructor(e,r,n,i,a,d){this.notificationService=e,this.storageService=r,this.appContext=n,this.dataLoader=i,this.creatureFactory=a,this.webSocketService=d,this.appContext.defaultLevel$.subscribe(u=>{this.scenarioLevel=u}),this.webSocketService.sessionId$.subscribe(u=>{null!=u&&(this.sessionId=u)})}startNewGame(){this.storageService.resetGame()}loadScenario(){var e=this;return(0,At.A)(function*(){const r=yield e.storageService.loadFile(e.scenarioId,e.scenarioLevel).catch(n=>e.notificationService.emitErrorMessage(`Failed to load scenario: ${n.message}`));r&&(r.forEach(n=>{const i={level:e.scenarioLevel,aggressive:!0,...n};e.appContext.addCreature(e.creatureFactory.createCreature(i))}),e.notificationService.emitInfoMessage(`Loaded scenario ${e.scenarioId} at level ${e.scenarioLevel}.`))})()}loadSection(){const e=this.sectionId.toString().replace("#","."),r=this.dataLoader.getData().sections.find(i=>i.index===e);if(!r||!r.rooms||0===r.rooms.length)return void this.notificationService.emitErrorMessage(`Section ${this.sectionId} contains no monsters`);const n=r.rooms.flatMap(i=>i.monster??[]).filter(i=>i);0!==n.length?(n.forEach(i=>{this.appContext.addCreature(this.creatureFactory.createCreature({type:i.name,level:this.scenarioLevel,isElite:"elite"===i?.type||"elite"===i?.player4,aggressive:!0}))}),this.notificationService.emitInfoMessage(`Loaded section ${e} at level ${this.scenarioLevel}.`)):this.notificationService.emitErrorMessage(`${this.sectionId} has no monsters for mission ${this.scenarioId}`)}startSession(){this.webSocketService.connect(F.im.Host)}joinSession(){this.webSocketService.connect(F.im.Client,this.sessionId)}static \u0275fac=function(r){return new(r||o)(t.rXU(O.J),t.rXU(Yt.s),t.rXU(_.B),t.rXU(G.X),t.rXU(B.Z),t.rXU(F.Vh))};static \u0275cmp=t.VBU({type:o,selectors:[["app-setup"]],decls:38,vars:7,consts:[["tabindex","0","role","button","aria-expanded","false",1,"icon","chevron",3,"click","ngClass"],["viewBox","0 0 24 24","width","24","height","24","stroke","currentColor","stroke-width","2","fill","none","stroke-linecap","round","stroke-linejoin","round"],["points","6 9 12 15 18 9"],[1,"setup-container","row","content"],[1,"section"],[1,"label-group"],["for","scenario-level"],["type","tel","placeholder","#",3,"ngModelChange","ngModel"],[1,"action-button",3,"click"],["for","scenario-id"],["for","section-id"],["type","tel","placeholder","1",3,"ngModelChange","ngModel"]],template:function(r,n){1&r&&(t.j41(0,"div",0),t.bIt("click",function(){return n.appContext.shouldShowSetup=!n.appContext.shouldShowSetup}),s.qSk(),t.j41(1,"svg",1),t.nrm(2,"polyline",2),t.k0s()(),s.joV(),t.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),t.EFF(7,"Level"),t.k0s(),t.j41(8,"input",7),t.mxI("ngModelChange",function(a){return t.DH7(n.scenarioLevel,a)||(n.scenarioLevel=a),a}),t.k0s()(),t.j41(9,"button",8),t.bIt("click",function(){return n.startNewGame()}),t.EFF(10,"New"),t.k0s()(),t.j41(11,"div",4)(12,"div",5)(13,"label",9),t.EFF(14,"Mission"),t.k0s(),t.j41(15,"input",7),t.mxI("ngModelChange",function(a){return t.DH7(n.scenarioId,a)||(n.scenarioId=a),a}),t.k0s()(),t.j41(16,"button",8),t.bIt("click",function(){return n.loadScenario()}),t.EFF(17,"Load"),t.k0s()(),t.j41(18,"div",4)(19,"div",5)(20,"label",10),t.EFF(21,"Section"),t.k0s(),t.j41(22,"input",7),t.mxI("ngModelChange",function(a){return t.DH7(n.sectionId,a)||(n.sectionId=a),a}),t.k0s()(),t.j41(23,"button",8),t.bIt("click",function(){return n.loadSection()}),t.EFF(24,"Load"),t.k0s()(),t.j41(25,"div",4)(26,"button",8),t.bIt("click",function(){return n.appContext.addMonsterToggled=!n.appContext.addMonsterToggled}),t.EFF(27," Add Monster"),t.k0s()(),t.j41(28,"div",4)(29,"button",8),t.bIt("click",function(){return n.startSession()}),t.EFF(30,"Host"),t.k0s()(),t.j41(31,"div",4)(32,"div",5)(33,"label",9),t.EFF(34,"ID"),t.k0s(),t.j41(35,"input",11),t.mxI("ngModelChange",function(a){return t.DH7(n.sessionId,a)||(n.sessionId=a),a}),t.k0s()(),t.j41(36,"button",8),t.bIt("click",function(){return n.joinSession()}),t.EFF(37,"Join"),t.k0s()()()),2&r&&(t.Y8G("ngClass",n.appContext.shouldShowSetup?"expanded":""),t.R7$(3),t.xc7("display",n.appContext.shouldShowSetup?null:"none"),t.R7$(5),t.R50("ngModel",n.scenarioLevel),t.R7$(7),t.R50("ngModel",n.scenarioId),t.R7$(7),t.R50("ngModel",n.sectionId),t.R7$(13),t.R50("ngModel",n.sessionId))},dependencies:[l.MD,l.YU,m.YN,m.me,m.BC,m.vS,C.S],styles:["[_nghost-%COMP%]{position:relative}.setup-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;align-items:center;background-color:var(--content-background-left);padding:10px 0 10px 5px}.setup-container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;padding-left:1rem;border-left:5px solid;gap:.5rem;flex:1 1 0px}.setup-container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .label-group[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.setup-container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .label-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding:0;font-size:20px}.setup-container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .label-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:60px}.setup-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none}@media (max-width: 768px){.setup-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}.chevron[_ngcontent-%COMP%]{position:absolute;display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;cursor:pointer;transition:transform .2s ease,color .2s ease;outline:none;top:10px;right:10px;color:var(--font-color-dark);border-radius:4px;padding:4px}.chevron.expanded[_ngcontent-%COMP%]{transform:rotate(180deg);top:0}.chevron[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}"]})}return o})();var Lt=p(3669),N=p(9974),Xt=p(4360);function Ht(o,c){return o===c}var Ut=p(5558),zt=p(6648);const A={now:()=>(A.delegate||Date).now(),delegate:void 0};class Jt extends b.B{constructor(c=1/0,e=1/0,r=A){super(),this._bufferSize=c,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,c),this._windowTime=Math.max(1,e)}next(c){const{isStopped:e,_buffer:r,_infiniteTimeWindow:n,_timestampProvider:i,_windowTime:a}=this;e||(r.push(c),!n&&r.push(i.now()+a)),this._trimBuffer(),super.next(c)}_subscribe(c){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(c),{_infiniteTimeWindow:r,_buffer:n}=this,i=n.slice();for(let a=0;a<i.length&&!c.closed;a+=r?1:2)c.next(i[a]);return this._checkFinalizedStatuses(c),e}_trimBuffer(){const{_bufferSize:c,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:n}=this,i=(n?1:2)*c;if(c<1/0&&i<r.length&&r.splice(0,r.length-i),!n){const a=e.now();let d=0;for(let u=1;u<r.length&&r[u]<=a;u+=2)d=u;d&&r.splice(0,d+1)}}}var Y=p(8750),D=p(7707);function w(o,c,...e){if(!0===c)return void o();if(!1===c)return;const r=new D.Ms({next:()=>{r.unsubscribe(),o()}});return(0,Y.Tg)(c(...e)).subscribe(r)}var Zt=p(4700);const Kt=o=>["Bonus Experience",o],qt=o=>["Gold Multiplier",o],te=o=>["Trap Damage",o],ee=o=>["Hazardous Terrain Damage",o],ne=o=>["Monster Level",o],oe=(o,c,e,r,n)=>[o,c,e,r,n],re=(o,c)=>c[0];function ie(o,c){if(1&o&&(t.rj2(0,"tr")(1,"td"),t.EFF(2),t.eux(),t.rj2(3,"td"),t.EFF(4),t.eux()()),2&o){const e=c.$implicit;t.R7$(2),t.JRh(e[0]),t.R7$(2),t.JRh(e[1])}}function ae(o,c){if(1&o&&(t.rj2(0,"tbody"),t.Z7z(1,ie,5,2,"tr",null,re),t.eux()),2&o){const e=c;t.R7$(),t.Dyx(t.s1E(10,oe,t.eq3(0,Kt,e.bonus_experience),t.eq3(2,qt,e.gold_conversion),t.eq3(4,te,e.trap_damage),t.eq3(6,ee,e.hazardous_terrain),t.eq3(8,ne,e.monster_level)))}}function ce(o,c){if(1&o&&(t.rj2(0,"table",1),t.nVh(1,ae,3,16,"tbody"),t.eux()),2&o){let e;t.R7$(),t.vxM((e=c.ref)?1:-1,e)}}let se=(()=>{class o{appContext=(0,s.WQX)(_.B);db=(0,s.WQX)(Zt.a);vm$=this.appContext.defaultLevel$.pipe(function Vt(o,c=Lt.D){return o=o??Ht,(0,N.N)((e,r)=>{let n,i=!0;e.subscribe((0,Xt._)(r,a=>{const d=c(a);(i||!o(n,d))&&(i=!1,n=d,r.next(a))}))})}(),(0,Ut.n)(e=>(0,zt.H)(this.db.getScenarioReference(e)).pipe((0,y.T)(r=>({level:e,ref:(Array.isArray(r)?r[0]:r)??null})))),function Wt(o,c,e){let r,n=!1;return o&&"object"==typeof o?({bufferSize:r=1/0,windowTime:c=1/0,refCount:n=!1,scheduler:e}=o):r=o??1/0,function Qt(o={}){const{connector:c=()=>new b.B,resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:n=!0}=o;return i=>{let a,d,u,f=0,h=!1,M=!1;const k=()=>{d?.unsubscribe(),d=void 0},R=()=>{k(),a=u=void 0,h=M=!1},ge=()=>{const x=a;R(),x?.unsubscribe()};return(0,N.N)((x,L)=>{f++,!M&&!h&&k();const j=u=u??c();L.add(()=>{f--,0===f&&!M&&!h&&(d=w(ge,n))}),j.subscribe(L),!a&&f>0&&(a=new D.Ms({next:I=>j.next(I),error:I=>{M=!0,k(),d=w(R,e,I),j.error(I)},complete:()=>{h=!0,k(),d=w(R,r),j.complete()}}),(0,Y.Tg)(x).subscribe(a))})(i)}}({connector:()=>new Jt(r,c,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:n})}({bufferSize:1,refCount:!0}));static \u0275fac=function(r){return new(r||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-legend"]],decls:5,vars:3,consts:[[1,"legend-container"],[1,"legend-table"]],template:function(r,n){if(1&r&&(t.rj2(0,"div",0)(1,"h3"),t.EFF(2,"References"),t.eux(),t.nVh(3,ce,2,1,"table",1),t.nI1(4,"async"),t.eux()),2&r){let i;t.R7$(3),t.vxM((i=t.bMT(4,1,n.vm$))?3:-1,i)}},dependencies:[l.MD,l.Jj],styles:[".legend-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--font-color)}.legend-container[_ngcontent-%COMP%]   .legend-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;table-layout:auto}.legend-container[_ngcontent-%COMP%]   .legend-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .legend-container[_ngcontent-%COMP%]   .legend-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;text-align:center;border:1px solid var(--font-color);color:var(--font-color)}.legend-container[_ngcontent-%COMP%]   .legend-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--background-secondary, var(--secondary-color));font-weight:700;color:var(--font-color-dark)}.legend-container[_ngcontent-%COMP%]   .legend-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, .legend-container[_ngcontent-%COMP%]   .legend-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{text-align:left}"]})}return o})();function le(o,c){1&o&&t.nrm(0,"app-element",5),2&o&&t.Y8G("element",c.$implicit)}function de(o,c){1&o&&t.nrm(0,"app-attack-modal")}function pe(o,c){1&o&&t.nrm(0,"app-add-monster")}let ue=(()=>{class o{appContext;elements=[{type:g.RJ.Fire,state:g.e_.None},{type:g.RJ.Ice,state:g.e_.None},{type:g.RJ.Earth,state:g.e_.None},{type:g.RJ.Air,state:g.e_.None},{type:g.RJ.Light,state:g.e_.None},{type:g.RJ.Dark,state:g.e_.None}];constructor(e){this.appContext=e}static \u0275fac=function(r){return new(r||o)(t.rXU(_.B))};static \u0275cmp=t.VBU({type:o,selectors:[["app-scenario"]],decls:11,vars:3,consts:[[1,"scenario-container"],[1,"content"],[1,"elements-row"],[3,"element",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"element"]],template:function(r,n){1&r&&(t.j41(0,"div",0),t.nrm(1,"app-setup"),t.j41(2,"div",1)(3,"div",2),t.DNE(4,le,1,1,"app-element",3),t.k0s(),t.nrm(5,"app-round"),t.k0s(),t.nrm(6,"app-game"),t.DNE(7,de,1,0,"app-attack-modal",4)(8,pe,1,0,"app-add-monster",4),t.nrm(9,"app-log")(10,"app-legend"),t.k0s()),2&r&&(t.R7$(4),t.Y8G("ngForOf",n.elements),t.R7$(3),t.Y8G("ngIf",n.appContext.selectedCreature),t.R7$(),t.Y8G("ngIf",n.appContext.addMonsterToggled))},dependencies:[l.MD,l.Sq,l.bT,Ct,kt,Bt,St,Nt,Mt,Dt,se],styles:[".scenario-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.content[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.content[_ngcontent-%COMP%]   .elements-row[_ngcontent-%COMP%]{display:flex;gap:10px}@media (max-width: 768px){.content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;align-items:stretch}.content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{min-width:0}.content[_ngcontent-%COMP%]   app-round[_ngcontent-%COMP%]{display:block;width:100%;justify-self:stretch}}"]})}return o})()}}]);